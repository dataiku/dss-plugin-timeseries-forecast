{
    "meta": {
        "label": "Forecast future values",
        "description": "Use previously trained models to forecast time series",
        "icon": "icon-signal",
        "displayOrderRank": 2
    },
    "kind": "PYTHON",
    "selectableFromDataset": "external_features_future_dataset",
    "selectableFromFolder": "model_folder",
    "inputRoles": [
        {
            "name": "model_folder",
            "label": "Trained models folder",
            "description": "The folder containing models stored by the \"Train\" recipe",
            "arity": "UNARY",
            "required": true,
            "acceptsDataset": false,
            "acceptsManagedFolder": true,
            "mustBeStrictlyType": "Filesystem"
        },
        {
            "name": "external_features_future_dataset",
            "label": "External features (optional)",
            "description": "If you passed external features to the \"Train\" recipe, this dataset must provide their values for the range of dates to forecast.",
            "arity": "UNARY",
            "required": false,
            "acceptsDataset": true,
            "acceptsFolder": false
        }
    ],
    "outputRoles": [
        {
            "name": "output_dataset",
            "label": "Forecast dataset",
            "description": "This dataset will store forecast values",
            "arity": "UNARY",
            "required": true,
            "acceptsDataset": true,
            "acceptsFolder": false
        }
    ],
    "paramsPythonSetup": "select_model_version.py",
    "params": [
        {
            "name": "separator_model_selection",
            "label": "Model selection",
            "type": "SEPARATOR"
        },
        {
            "name": "model_selection_mode",
            "label": "Selection mode",
            "type": "SELECT",
            "mandatory": true,
            "defaultValue": "auto",
            "description": "Auto mode selects the best model from the latest train session",
            "getChoicesFromPython": true
        },
        {
            "name": "performance_metric",
            "label": "Performance metric",
            "type": "SELECT",
            "mandatory": false,
            "defaultValue": "MASE",
            "visibilityCondition": "model.model_selection_mode == 'auto'",
            "selectChoices": [
                {
                    "value": "MSE",
                    "label": "Mean Squared Error"
                },
                {
                    "value": "MASE",
                    "label": "Mean Absolute Scaled Error"
                },
                {
                    "value": "MAPE",
                    "label": "Mean Absolute Percentage Error"
                },
                {
                    "value": "sMAPE",
                    "label": "Mean Absolute Percentage Error (symmetric)"
                },
                {
                    "value": "MSIS",
                    "label": "Mean Scaled Interval Score"
                },
                {
                    "value": "ND",
                    "label": "ND"
                },
                {
                    "value": "RMSE",
                    "label": "Root Mean Squared Error"
                },
                {
                    "value": "mean_wQuantileLoss",
                    "label": "Mean weighted Quantile Loss"
                }
            ]
        },
        {
            "name": "manually_selected_session",
            "type": "SELECT",
            "label": "Training session",
            "getChoicesFromPython": true,
            "visibilityCondition": "model.model_selection_mode == 'manual'"
        },
        {
            "name": "manually_selected_model_label",
            "type": "SELECT",
            "label": "Model name",
            "getChoicesFromPython": true,
            "visibilityCondition": "model.model_selection_mode == 'manual'"
        },
        {
            "name": "separator_forecasting",
            "label": "Prediction",
            "type": "SEPARATOR"
        },
        {
            "name": "prediction_length",
            "label": "Forecast horizon",
            "type": "INT",
            "mandatory": true,
            "defaultValue": -1,
            "description": "A value of -1 sets the horizon to the one used at training time. Expressed in number of time steps, it must be smaller than the horizon used at training time.",
            "minI": -1
        },
        {
            "name": "quantiles",
            "label": "Quantiles",
            "type": "DOUBLES",
            "mandatory": true,
            "defaultValue": [
                0.1,
                0.5,
                0.9
            ],
            "description": "Quantiles are values that divide a distribution such that there is a given proportion of observations below them. The median corresponds to the quantile of value 0.5."
        },
        {
            "name": "include_history",
            "label": "Include history?",
            "description": "Keep historical data in addition to future values.",
            "type": "BOOLEAN",
            "defaultValue": false,
            "mandatory": true
        }
    ],
    "resourceKeys": []
}